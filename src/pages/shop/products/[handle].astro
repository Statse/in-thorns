---
import { medusa } from '../../../scripts/medusa'
import EcommLayout from '../../../layouts/EcommLayout.astro'
import Main from '../../../components/main.astro'

const { handle } = Astro.params

if (!handle) {
  throw new Error('Product is required')
}

console.log('handle', handle)

const productResponse = await medusa.products.list({
  handle: handle
})

if (!productResponse) {
  throw new Error('productResponse is ' + productResponse)
}

console.log('productResponse', productResponse)

const product = productResponse.products[0]

console.log(product)

if (!product) {
  throw new Error('Product not found')
}

const title = product.title || handle
---

<!-- Why the fuck this breaks the product page?  style='background-image: url("candles.jpg")' -->
<EcommLayout title={title}>
  <main
    class='m-4 border-white text-white border-2 flex flex-col h-full flex-1 gap-8 items-center bg-no-repeat bg-contain md:bg-cover bg-top bg-fixed'
  >
    {title}
  </main>
</EcommLayout>
