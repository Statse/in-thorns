---
import { medusa } from '../scripts/medusa'
import EcommLayout from '../layouts/EcommLayout.astro'
import ProductCard from '../components/productCard.astro'

const productsResponse = await medusa.products
  .list()
  .catch((err) => console.log(err))

if (!productsResponse) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  })
}

const { products } = productsResponse

console.log(products[0])
---

<style></style>
<EcommLayout title='In Thorns Web Store'>
  <main
    class='m-4 border-white text-white border-2 flex flex-col h-full flex-1 gap-8 items-center bg-no-repeat bg-contain md:bg-cover bg-top bg-fixed bg-co'
    style='background-image: url("candles.jpg")'
  >
    <nav class='h-24 w-full flex items-center justify-center'>
      <img src='it-logo-white.png' class='h-20' alt='In Thorns logo' />
    </nav>
    <section class='container-md flex flex-col px-8'>
      <h1 class='font-khmer text-2xl'>Products</h1>
      <div
        class='flex flex-row gap-16 flex-wrap w-full h-full justify-center py-4'
      >
        {
          products.map(({ handle, thumbnail, title }) => (
            <ProductCard
              image={thumbnail || ''}
              handle={handle || ''}
              title={title || ''}
              price={25}
            />
          ))
        }
      </div>
    </section>
  </main>
</EcommLayout>
